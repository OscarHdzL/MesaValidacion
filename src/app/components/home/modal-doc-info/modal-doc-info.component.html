<div class="flex items-center" mat-dialog-title>
  <h2 class="headline flex-auto">Información de documento <b>{{ this.documento.documento}}</b></h2>
  <button></button>
  <button class="text-secondary" mat-dialog-close mat-icon-button type="button">
    <mat-icon svgIcon="mat:close"></mat-icon>
  </button>
</div>

<mat-divider class="-mx-6 text-border"></mat-divider>
<mat-dialog-content>
  <mat-tab-group animationDuration="2ms" [(selectedIndex)]="indexTab">
    <mat-tab label="Última versión" *ngIf="this.ultimaVersionModel && this.permiso_MostrarUltimaVersion">
      <div class="p-2">
        <section class="bg-white white:bg-gray-900">
          <div class="py-8 lg:py-16 px-4">
            <form
              role="form"
              autocomplete="off"
              [formGroup]="formVersionDocumentoEdicion"
              novalidate
              class="space-y-8"
            >
              <div>
                <label
                  for="descripcion"
                  class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-600"
                >
                  Descripción corta
                </label>
                <input
                  type="text"
                  id="text"
                  formControlName="descripcion"
                  class="shadow-sm bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 dark:shadow-sm-light"
                  placeholder="Escribe aquí"
                  required
                />
              </div>

              <div>
                <label
                  for="message"
                  class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-600"
                >
                  Descripción larga
                </label>
                <textarea
                  id="message"
                  rows="6"
                  formControlName="detalle"
                  class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg shadow-sm border border-gray-300 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
                  placeholder="Escribe aquí.."
                ></textarea>
              </div>

              <!-- <div class="flex xl:flex-row lg:flex-row md:flex-row flex-col"> -->
              <div
                class="flex xl:flex-row lg:flex-row md:flex-row flex-col grid xl:grid-cols-2 lg:grid-cols-2 md:grid-cols-2 grid-cols-1 gap-2"
              >
                <!-- <div class="xl:basis-1/2 lg:basis-1/2 md:basis-1/2 basis-full m-4"> -->
                <div>
                  <label
                    for="message"
                    class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-600"
                  >
                    Documento editable
                  </label>
                  <div>
                    <label
                      for="dropzone-file"
                      class="flex flex-col items-center justify-center w-full h-64 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 dark:hover:bg-bray-800 dark:bg-gray-700 hover:bg-gray-100 dark:border-gray-600 dark:hover:border-gray-500 dark:hover:bg-gray-600"
                    >
                      <div
                        class="flex flex-col items-center justify-center pt-5 pb-6"
                      >
                        <svg
                          aria-hidden="true"
                          class="w-10 h-10 mb-3 text-gray-400"
                          fill="none"
                          stroke="currentColor"
                          viewBox="0 0 24 24"
                          xmlns="http://www.w3.org/2000/svg"
                        >
                          <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15
                                                    13l-3-3m0 0l-3 3m3-3v12"
                          ></path>
                        </svg>
                        <p
                          class="mb-2 text-sm text-gray-500 dark:text-gray-400"
                        >
                          <span class="font-semibold"
                            >{{
                              this.archivoEditableNombreEdicion
                                ? archivoEditableNombreEdicion
                                : "Click para subir archivo editable"
                            }}
                          </span>
                        </p>
                        <p
                          class="text-xs text-gray-500 dark:text-gray-400"
                          *ngIf="!this.archivoEditableNombreEdicion"
                        >
                          PDF, WORD, EXCEL
                        </p>
                      </div>
                      <input
                        id="dropzone-file"
                        type="file"
                        class="hidden"
                        (change)="editableSeleccionadoEdicion($event)"
                      />
                    </label>
                  </div>
                </div>
                <div>
                  <label
                    for="message"
                    class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-600"
                  >
                    Documento firmado
                  </label>
                  <div class="basis-1/2">
                    <label
                      for="dropzone-file-2"
                      class="flex flex-col items-center justify-center w-full h-64 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 dark:hover:bg-bray-800 dark:bg-gray-700 hover:bg-gray-100 dark:border-gray-600 dark:hover:border-gray-500 dark:hover:bg-gray-600"
                    >
                      <div
                        class="flex flex-col items-center justify-center pt-5 pb-6"
                      >
                        <svg
                          aria-hidden="true"
                          class="w-10 h-10 mb-3 text-gray-400"
                          fill="none"
                          stroke="currentColor"
                          viewBox="0 0 24 24"
                          xmlns="http://www.w3.org/2000/svg"
                        >
                          <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15
                                                    13l-3-3m0 0l-3 3m3-3v12"
                          ></path>
                        </svg>

                        <p
                          class="mb-2 text-sm text-gray-500 dark:text-gray-400"
                        >
                          <span class="font-semibold"
                            >{{
                              this.archivoFirmadoNombreEdicion
                                ? archivoFirmadoNombreEdicion
                                : "Click para subir archivo firmado"
                            }}
                          </span>
                        </p>
                        <p
                          class="text-xs text-gray-500 dark:text-gray-400"
                          *ngIf="!this.archivoFirmadoNombreEdicion"
                        >
                          PDF, WORD, EXCEL
                        </p>
                      </div>
                      <input
                        id="dropzone-file-2"
                        type="file"
                        class="hidden"
                        (change)="firmadoSeleccionadoEdicion($event)"
                      />
                    </label>
                  </div>
                </div>
              </div>
              <div class="flex justify-end mr-5 gap-2 xl:flex-row lg:flex-row md:flex-row sm:flex-row flex-col">
              <!-- <div class="flex xl:flex-row lg:flex-row md:flex-row sm:flex-row flex-col"> -->
                <!-- <div class="basis-4/6"></div> -->
                <div class="mr-2">
                  <button
                    class="py-3 px-6 bg-blue-500 text-white font-bold w-full sm:w-32 mt-5"
                    (click)="comentariosAgregar()"
                  >
                    Comentarios
                  </button>
                </div>
                <div class="mr-2">
                  <button
                    class="py-3 px-6 bg-green-500 text-white font-bold w-full sm:w-32 mt-5"
                    [disabled]="formVersionDocumentoEdicion.invalid"
                    (click)="editarVersionDocumento()"
                  >
                    Guardar
                  </button>
                </div>
              </div>
            </form>
          </div>
        </section>
      </div>
    </mat-tab>
    <mat-tab label="Historico" *ngIf="this.permiso_MostrarHistorico">
      <!-- <vex-tab-historico [documento]="this.objeto"></vex-tab-historico> -->

      <div
        class="flex-wrap m-5 grid xl:grid-cols-5 lg:grid-cols-4 md:grid-cols-3 sm:grid-cols-2 grid-cols-1 gap-2"
        *ngIf="this.listaVersionesDocumento.length > 0"
      >
        <div
          [ngClass]=" !this.item.ultimaVersion ? 'p-2 bg-white border border-cyan-200 rounded-lg shadow hover:bg-cyan-100 dark:bg-cyan-800 dark:border-cyan-700 dark:hover:bg-cyan-700' : 'p-2 bg-white border border-teal-200 rounded-lg shadow hover:bg-teal-100 dark:bg-teal-800 dark:border-teal-700 dark:hover:bg-teal-700'"
          *ngFor="let item of this.listaVersionesDocumento"
        >
          <div class="flex flex-col grid grid-cols-1">
            <div class="justify-self-end">
              <a
                *ngIf="this.item.validado"
                matTooltip="Validado"
                mat-icon-button
              >
              <mat-icon svgIcon="mat:check_circle_outline" style="fill: greenyellow"></mat-icon>
            </a>
              <a
                *ngIf="this.item.ultimaVersion && !this.item.validado && this.permiso_ValidarVersion"
                matTooltip="Validar versión"
                mat-icon-button
                (click)="ValidarVersion(this.item)"
              >
              <mat-icon svgIcon="mat:check_circle_outline" style="fill: dodgerblue"></mat-icon>
            </a>
          </div>
            <h5
              class="mb-2 text-2xl font-bold tracking-tight text-gray-900 dark:text-white flex justify-self-center"
            >
              Versión #{{ item.version }}
            </h5>
            <p
              class="font-normal text-gray-700 dark:text-gray-400 flex justify-self-center"
            >
              Descripción: {{ item.descripcion }}
            </p>


            <div class="flex flex-col justify-self-center mt-3">
              <div>
                <button
                  class="bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-1 px-1 rounded m-1"
                  (click)="abrirDocumento(item.editable)"
                  *ngIf="item.editable && !item.mostrarVisualizacionEditable"
                >
                  Descargar editable
                </button>
                <button
                  class="bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-1 px-1 rounded m-1"
                  (click)="verDocumento(item.editable)"
                  *ngIf="item.editable && item.mostrarVisualizacionEditable"
                >
                  Visualizar editable
                </button>
              </div>

              <div>
                <button
                class="bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-1 px-1 rounded m-1"
                  (click)="abrirDocumento(item.firmado)"
                  *ngIf="item.firmado && !item.mostrarVisualizacionFirmado"
                >
                  Descargar firmado
                </button>
                <button
                class="bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-1 px-1 rounded m-1"
                  (click)="verDocumento(item.firmado)"
                  *ngIf="item.firmado && item.mostrarVisualizacionFirmado"
                >
                  Visualizar firmado
                </button>
              </div>

              <div>
                <button
                class="bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-1 px-1 rounded m-1"
                  (click)="comentarios(item)"
                >
                 &nbsp; Ver comentarios &nbsp;
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="m-4" *ngIf="this.listaVersionesDocumento.length == 0">
        <div>
          <p style="text-align: center">No se encontraron registros</p>
        </div>
      </div>
    </mat-tab>
    <mat-tab label="Nueva versión" *ngIf="this.permiso_MostrarNuevaVersion">
      <div class="p-2">
        <section class="bg-white white:bg-gray-900">
          <div class="py-8 lg:py-16 px-4">
            <form
              role="form"
              autocomplete="off"
              [formGroup]="formVersionDocumento"
              novalidate
              class="space-y-8"
            >
              <div>
                <label
                  for="descripcion"
                  class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-600"
                >
                  Descripción corta
                </label>
                <input
                  type="text"
                  id="text"
                  formControlName="descripcion"
                  class="shadow-sm bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 dark:shadow-sm-light"
                  placeholder="Escribe aquí"
                  required
                />
              </div>

              <div>
                <label
                  for="message"
                  class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-600"
                >
                  Descripción larga
                </label>
                <textarea
                  id="message"
                  rows="6"
                  formControlName="detalle"
                  class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg shadow-sm border border-gray-300 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500"
                  placeholder="Escribe aquí.."
                ></textarea>
              </div>

              <!-- <div class="flex xl:flex-row lg:flex-row md:flex-row flex-col"> -->
              <div
                class="flex xl:flex-row lg:flex-row md:flex-row flex-col grid xl:grid-cols-2 lg:grid-cols-2 md:grid-cols-2 grid-cols-1 gap-2"
              >
                <!-- <div class="xl:basis-1/2 lg:basis-1/2 md:basis-1/2 basis-full m-4"> -->
                <div>
                  <label
                    for="message"
                    class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-600"
                  >
                    Documento editable
                  </label>
                  <div>
                    <label
                      for="dropzone-file"
                      class="flex flex-col items-center justify-center w-full h-64 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 dark:hover:bg-bray-800 dark:bg-gray-700 hover:bg-gray-100 dark:border-gray-600 dark:hover:border-gray-500 dark:hover:bg-gray-600"
                    >
                      <div
                        class="flex flex-col items-center justify-center pt-5 pb-6"
                      >
                        <svg
                          aria-hidden="true"
                          class="w-10 h-10 mb-3 text-gray-400"
                          fill="none"
                          stroke="currentColor"
                          viewBox="0 0 24 24"
                          xmlns="http://www.w3.org/2000/svg"
                        >
                          <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15
                                                    13l-3-3m0 0l-3 3m3-3v12"
                          ></path>
                        </svg>
                        <p
                          class="mb-2 text-sm text-gray-500 dark:text-gray-400"
                        >
                          <span class="font-semibold"
                            >{{
                              this.archivoEditableNombre
                                ? archivoEditableNombre
                                : "Click para subir archivo editable"
                            }}
                          </span>
                        </p>
                        <p
                          class="text-xs text-gray-500 dark:text-gray-400"
                          *ngIf="!this.archivoEditableNombre"
                        >
                          PDF, WORD, EXCEL
                        </p>
                      </div>
                      <input
                        id="dropzone-file"
                        type="file"
                        class="hidden"
                        (change)="editableSeleccionado($event)"
                      />
                    </label>
                  </div>
                </div>
                <div>
                  <label
                    for="message"
                    class="block mb-2 text-sm font-medium text-gray-900 dark:text-gray-600"
                  >
                    Documento firmado
                  </label>
                  <div class="basis-1/2">
                    <label
                      for="dropzone-file-2"
                      class="flex flex-col items-center justify-center w-full h-64 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 dark:hover:bg-bray-800 dark:bg-gray-700 hover:bg-gray-100 dark:border-gray-600 dark:hover:border-gray-500 dark:hover:bg-gray-600"
                    >
                      <div
                        class="flex flex-col items-center justify-center pt-5 pb-6"
                      >
                        <svg
                          aria-hidden="true"
                          class="w-10 h-10 mb-3 text-gray-400"
                          fill="none"
                          stroke="currentColor"
                          viewBox="0 0 24 24"
                          xmlns="http://www.w3.org/2000/svg"
                        >
                          <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15
                                                    13l-3-3m0 0l-3 3m3-3v12"
                          ></path>
                        </svg>

                        <p
                          class="mb-2 text-sm text-gray-500 dark:text-gray-400"
                        >
                          <span class="font-semibold"
                            >{{
                              this.archivoFirmadoNombre
                                ? archivoFirmadoNombre
                                : "Click para subir archivo firmado"
                            }}
                          </span>
                        </p>
                        <p
                          class="text-xs text-gray-500 dark:text-gray-400"
                          *ngIf="!this.archivoFirmadoNombre"
                        >
                          PDF, WORD, EXCEL
                        </p>
                      </div>
                      <input
                        id="dropzone-file-2"
                        type="file"
                        class="hidden"
                        (change)="firmadoSeleccionado($event)"
                      />
                    </label>
                  </div>
                </div>
              </div>
              <div class="flex justify-end mr-5">
                <button
                  class="py-3 px-6 bg-green-500 text-white font-bold w-full sm:w-32 mt-5"
                  [disabled]="formVersionDocumento.invalid"
                  (click)="guardarVersionDocumento()"
                >
                  Guardar
                </button>
              </div>
            </form>
          </div>
        </section>
      </div>
    </mat-tab>

  </mat-tab-group>
</mat-dialog-content>
